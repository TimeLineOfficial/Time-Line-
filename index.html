<!doctype html>
<html lang="en"> 
<head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <meta http-equiv="X-UA-Compatible" content="ie=edge"> 
  <title>TIME LINE - Delivering Emotions On Time</title> 
  <style type="text/css" id="dcoder_stylesheet">body {
  font-family: Arial, sans-serif;
  background-color: #121212;
  color: #ffffff;
  margin: 0;
  padding: 0;
}

header {
  background-color: #1f1f1f;
  text-align: center;
  padding: 20px;
}

header h1 {
  margin: 0;
  color: #ff6347;
}

header p {
  margin: 0;
  color: #ccc;
}

nav {
  background-color: #333;
  padding: 10px 0;
  position: sticky;
  top: 0;
  z-index: 1000;
}

nav ul {
  list-style: none;
  display: flex;
  justify-content: center;
  padding: 0;
  margin: 0;
  flex-wrap: wrap;
}

nav ul li {
  margin: 5px 10px;
}

nav ul li a {
  text-decoration: none;
  color: #fff;
  font-weight: bold;
  font-size: 14px;
}

nav ul li a:hover {
  color: #ff6347;
}

.section {
  padding: 20px;
  text-align: center;
}

form {
  display: flex;
  flex-direction: column;
  max-width: 500px;
  margin: 0 auto;
}

form label {
  margin-top: 10px;
  text-align: left;
}

form input, form textarea, form select, form button {
  margin-top: 5px;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #444;
  background-color: #1f1f1f;
  color: #fff;
}

form button {
  background-color: #ff6347;
  border: none;
  cursor: pointer;
}

form button:hover {
  background-color: #ff4500;
}

footer {
  background-color: #1f1f1f;
  text-align: center;
  padding: 10px 0;
  margin-top: 20px;
}

.info {
  cursor: pointer;
  color: #ff6347;
  font-weight: bold;
  display: inline-block;
  margin-left: 5px;
}

.info:hover {
  text-decoration: underline;
}

.token {
  color: #ffcc00;
  font-weight: bold;
}

.service-info {
  color: #ff6347;
  font-weight: bold;
}

#askButton {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #ff6347;
  color: #fff;
  border: none;
  padding: 10px 20px;
  cursor: pointer;
  border-radius: 5px;
}

#askButton:hover {
  background-color: #ff4500;
}

.upload-section {
  margin-top: 15px;
  padding: 15px;
  background-color: #1f1f1f;
  border-radius: 5px;
}

.upload-section h3 {
  margin-top: 0;
}

.file-input-label {
  display: block;
  margin-bottom: 10px;
}

.popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #1f1f1f;
  padding: 20px;
  border-radius: 5px;
  z-index: 1001;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

.popup button {
  margin-top: 10px;
}

.success-message {
  color: #4CAF50;
  font-weight: bold;
  margin-top: 20px;
}

.error-message {
  color: #f44336;
  font-weight: bold;
  margin-top: 20px;
}

.total-amount {
  background-color: #333;
  padding: 15px;
  margin: 20px 0;
  border-radius: 5px;
  font-weight: bold;
  font-size: 1.2em;
}

.contact-options {
  display: none;
  position: fixed;
  bottom: 80px;
  right: 20px;
  background-color: #1f1f1f;
  padding: 15px;
  border-radius: 5px;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
  z-index: 1000;
}

.contact-options button {
  display: block;
  width: 100%;
  margin: 5px 0;
  padding: 8px 15px;
  background-color: #ff6347;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.contact-options button:hover {
  background-color: #ff4500;
}

.company-address {
  background-color: #1f1f1f;
  padding: 15px;
  border-radius: 5px;
  margin: 15px 0;
  text-align: left;
}

.company-address h3 {
  margin-top: 0;
  color: #ff6347;
}

/* Timeline Styles from second code */
.timeline {
  position: relative;
  padding: 20px 0;
  max-width: 1000px;
  margin: 0 auto;
}

.timeline::before {
  content: '';
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 2px;
  background-color: #ff6347;
  transform: translateX(-50%);
}

.timeline-item {
  position: relative;
  margin-bottom: 40px;
  width: 50%;
  padding: 20px;
  box-sizing: border-box;
  background-color: #1f1f1f;
  border-radius: 5px;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
}

.timeline-item:nth-child(odd) {
  margin-left: 0;
  margin-right: auto;
}

.timeline-item:nth-child(even) {
  margin-left: auto;
  margin-right: 0;
}

.timeline-item::after {
  content: '';
  position: absolute;
  top: 30px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background-color: #ff6347;
}

.timeline-item:nth-child(odd)::after {
  right: -10px;
}

.timeline-item:nth-child(even)::after {
  left: -10px;
}

.timeline-date {
  font-weight: bold;
  color: #ff6347;
  margin-bottom: 10px;
}

.timeline-content h3 {
  margin-top: 0;
  color: #ff6347;
}

.timeline-content p {
  color: #ccc;
}

/* Order form from second code - adapted to match your style */
.order-form-container {
  background-color: #1f1f1f;
  padding: 30px;
  border-radius: 5px;
  margin: 40px auto;
  max-width: 800px;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

.form-group input, 
.form-group textarea, 
.form-group select {
  width: 100%;
  padding: 10px;
  border: 1px solid #444;
  border-radius: 4px;
  font-family: inherit;
  font-size: inherit;
  background-color: #1f1f1f;
  color: #fff;
}

.file-upload {
  margin-top: 10px;
  color: #ccc;
}

@media (max-width: 768px) {
  .timeline::before {
    left: 20px;
  }
  
  .timeline-item {
    width: 100%;
    padding-left: 50px;
    padding-right: 20px;
  }
  
  .timeline-item:nth-child(odd),
  .timeline-item:nth-child(even) {
    margin-left: 0;
    margin-right: 0;
  }
  
  .timeline-item::after {
    left: 10px;
  }
}

@media (max-width: 600px) {
  nav ul {
    justify-content: space-around;
  }
  
  nav ul li {
    margin: 5px;
  }
  
  nav ul li a {
    font-size: 12px;
  }
  
  form {
    padding: 0 10px;
  }
  
  .section {
    padding: 15px 10px;
  }
  
  .company-address {
    padding: 10px;
    font-size: 0.9em;
  }
}</style> 
</head> 
<body> 
  <header> 
   <div class="logo"> 
    <h1>TIME LINE</h1> 
    <p>Delivering Emotions On Time</p> 
   </div> 
  </header> 
  <nav> 
   <ul> 
    <li><a href="#home">Home</a></li> 
    <li><a href="#features">Features</a></li> 
    <li><a href="#timeline">Our Story</a></li>
    <li><a href="#order">Order Now</a></li> 
    <li><a href="#price">Price</a></li> 
    <li><a href="#policy">Policy</a></li> 
    <li><a href="#contact">Contact</a></li> 
   </ul> 
  </nav> 
  <section id="home" class="section"> 
   <h2>Welcome to TIME LINE</h2> 
   <p>Delivering emotions, surprises, and gifts to your loved ones on time.</p> 
  </section> 
  <section id="features" class="section"> 
   <h2>Why Choose Us?</h2> 
   <ul> 
    <li>Specific date and time delivery</li> 
    <li>Personalized message reading</li> 
    <li>Live delivery viewing via video call</li> 
    <li>Handwritten or printed letters</li> 
    <li>Secure and reliable service</li> 
   </ul> 
   <p class="service-info">This service is currently available only in Varanasi and Chandauli.</p> 
  </section> 
  
  <!-- New Timeline Section -->
  <section id="timeline" class="section">
    <h2>Our Journey</h2>
    <div class="timeline">
      <div class="timeline-item">
        <div class="timeline-date">January 2023</div>
        <div class="timeline-content">
          <h3>Time Line Founded</h3>
          <p>Started with a vision to deliver emotions and surprises at the perfect moment.</p>
        </div>
      </div>
      
      <div class="timeline-item">
        <div class="timeline-date">March 2023</div>
        <div class="timeline-content">
          <h3>First 100 Deliveries</h3>
          <p>Successfully completed our first 100 deliveries with 100% customer satisfaction.</p>
        </div>
      </div>
      
      <div class="timeline-item">
        <div class="timeline-date">June 2023</div>
        <div class="timeline-content">
          <h3>Expanded to Chandauli</h3>
          <p>Extended our services to Chandauli district after success in Varanasi.</p>
        </div>
      </div>
      
      <div class="timeline-item">
        <div class="timeline-date">December 2023</div>
        <div class="timeline-content">
          <h3>1000+ Happy Customers</h3>
          <p>Celebrated serving over 1000 customers with our unique delivery service.</p>
        </div>
      </div>
    </div>
  </section>
  
  <section id="order" class="section"> 
   <h2>Place Your Order</h2> 
   <form id="orderForm"> 
    <label for="customerName">Your Name (Optional):</label> 
    <input type="text" id="customerName" name="customerName" placeholder="Leave blank for a random token"> 
    <p id="tokenDisplay" class="token"></p> 
    <label for="phoneNumber">Your Phone Number:</label> 
    <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="Enter your phone number" pattern="^[0-9]{10}$" required> 
    <label for="photoUpload">Upload Photo <span class="info" id="photoInfo">?</span></label> 
    <input type="file" id="photoUpload" name="photoUpload" accept="image/*"> 
    <label for="recipientName">Recipient's Name:</label> 
    <input type="text" id="recipientName" name="recipientName" required> 
    <label for="recipientPhoneNumber">Recipient's Phone Number (Optional):</label> 
    <input type="tel" id="recipientPhoneNumber" name="recipientPhoneNumber" placeholder="Enter recipient's phone number" pattern="^[0-9]{10}$"> 
    <label for="address">Recipient's Address:</label> 
    <textarea id="address" name="address" rows="3" required></textarea> 
    <label for="district">District:</label> 
    <select id="district" name="district" required> 
     <option value="Varanasi">Varanasi</option> 
     <option value="Chandauli">Chandauli</option> 
    </select> 
    <label for="state">State:</label> 
    <select id="state" name="state" required> 
     <option value="Uttar Pradesh">Uttar Pradesh</option> 
    </select> 
    <label for="pincode">Pin Code:</label> 
    <input type="text" id="pincode" name="pincode" pattern="^[0-9]{6}$" required> 
    <label for="itemType">Item Type:</label> 
    <select id="itemType" name="itemType" required> 
     <option value="">-- Select Item Type --</option>
     <option value="message">Message (Speak in front of Recipient)</option> 
     <option value="writtenByTimeline">Letter written by Time Line (In Your Words)</option> 
     <option value="itemsSendByCustomer">Items (Send by Customer)</option> 
     <option value="itemsBuyByTimeline">Items (Buy by Time Line)</option> 
    </select> 
    <div id="additionalSections"></div> 
    <div id="totalAmount" class="total-amount">Total Amount: ₹0</div>
    <label for="deliveryDate">Delivery Date:</label> 
    <input type="date" id="deliveryDate" name="deliveryDate" required> 
    <label for="deliveryTime">Delivery Time:</label> 
    <input type="time" id="deliveryTime" name="deliveryTime" required> 
    <label><input type="checkbox" id="liveDelivery" name="liveDelivery"> Check to see live/recorded delivery</label> 
    <div id="liveDeliveryOptions"></div> 
    
    <div class="company-address">
      <h3>Our Office Address (For Item Drop-off):</h3>
      <p>Time Line Office, Parle-G factory, Patanava</p>
      <p>Ramnagar industrial area, Ramnagar</p>
      <p>Varanasi, Uttar Pradesh - 221008</p>
      <p>Contact: 7007677139 (Call/WhatsApp)</p>
      <p>Email: timelinedeliveryofficial@gmail.com</p>
    </div>
    
    <button type="submit">Proceed to Payment</button> 
   </form> 
  </section> 
  <section id="price" class="section"> 
   <h2>Price List</h2> 
   <ul> 
    <li>Normal delivery (Including letters, Voice message, small gifts, etc): ₹249</li>
    <li>Items Delivery (Send by customer or buy by Time Line): ₹299</li>
   </ul>
   <p class="instruction">Note - All delivery will include any specific acts like Singing, shayari, Confession, etc.</p>
   <p class="instruction">Note - All these things will be completed in less than 15 minutes.</p>
  </section> 
  <section id="policy" class="section"> 
   <h2>Policy</h2> 
   <ul> 
    <li>Refund Policy: If delivery fails, the amount (excluding distance charges) will be refunded within twelve hours.</li> 
    <li>If the customer wants the parcel back, they must pay courier charges for retrieval and ₹20 extra for convenience charges.</li> 
    <li>For warranty claims on items sent by customer, we'll record opening the package and refund full amount (excluding ₹100 fuel charge) if items are damaged/missing.</li>
   </ul> 
  </section> 
  <section id="contact" class="section"> 
   <h2>Contact Us</h2> 
   <p>Email: <a href="mailto:timelinedeliveryofficial@gmail.com">timelinedeliveryofficial@gmail.com</a></p> 
   <p>Instagram: <a href="https://www.instagram.com/time_line.official?igsh=MTZoaDYwb25wOWdkbw==" target="_blank">@time_line.official</a></p> 
   <p>Address: Time Line Office, Parle-G factory, Patanava, Ramnagar industrial area, Ramnagar, Varanasi, Uttar Pradesh, 221008</p> 
   <p>Contact no.: 7007677139 (Call/WhatsApp)</p> 
  </section> 
  <footer> 
   <p>© 2025 TIME LINE. All Rights Reserved.</p> 
  </footer> 
  <button id="askButton">Ask</button>
  <div id="contactOptions" class="contact-options">
    <button onclick="redirectToInstagram()">Instagram</button>
    <button onclick="redirectToGmail()">Gmail</button>
    <button onclick="hideContactOptions()">Back</button>
  </div>
  <div id="popup" class="popup"> 
   <p id="popupMessage"></p> 
   <button onclick="closePopup()">OK</button> 
  </div> 
 
<script type="text/javascript" id="dcoder_script">
// Configuration - Replace with your actual Google Apps Script URL
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby5wtRs_ShNdA4vx8QjGXVdT_rBFcdWlvQVIGy_ypHiZtwUUWFQ71eodoJfVOP3mtav/exec';

// Generate Random Alphanumeric Token
function generateToken() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let token = '';
  for (let i = 0; i < 8; i++) {
    token += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return token;
}

// Convert file to Base64
async function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve({
      filename: file.name,
      mimeType: file.type,
      content: reader.result.split(',')[1]
    });
    reader.onerror = error => reject(error);
  });
}

// Submit form data to Google Sheets
async function submitFormData(formData) {
  // Prepare all data
  const submission = {
    tokenNumber: document.getElementById("tokenDisplay").textContent.replace("Your Token: ", "") || generateToken(),
    customerName: formData.customerName,
    phoneNumber: formData.phoneNumber,
    recipientName: formData.recipientName,
    recipientPhoneNumber: formData.recipientPhoneNumber,
    address: formData.address,
    district: formData.district,
    state: formData.state,
    pincode: formData.pincode,
    itemType: formData.itemType,
    deliveryDate: formData.deliveryDate,
    deliveryTime: formData.deliveryTime,
    liveDelivery: document.getElementById("liveDelivery").checked,
    totalAmount: calculateTotalAmount()
  };

  // Add conditional fields
  const messageText = document.querySelector('textarea[name="message"]')?.value;
  if (messageText) submission.messageText = messageText;
  
  const productDescription = document.querySelector('textarea[name="productDescription"]')?.value;
  if (productDescription) submission.productDescription = productDescription;
  
  const productPrice = document.getElementById("productPrice")?.value;
  if (productPrice) submission.productPrice = productPrice;
  
  const productLink = document.querySelector('input[name="productLink"]')?.value;
  if (productLink) submission.productLink = productLink;
  
  const instructions = document.querySelector('textarea[name="instructions"]')?.value;
  if (instructions) submission.instructions = instructions;
  
  if (document.getElementById("claimWarranty")?.checked) submission.claimWarranty = true;
  
  if (document.getElementById("liveDelivery").checked) {
    submission.deliveryMethod = document.getElementById("deliveryMethod").value;
    submission.platform = document.getElementById("platform").value;
    submission.platformDetails = document.getElementById(
      submission.platform === 'whatsapp' ? 'whatsappNumber' :
      submission.platform === 'googleMeet' ? 'email' : 'instagramId'
    ).value;
  }

  // Process file uploads
  const filesToUpload = [
    { id: 'photoUpload', field: 'photo' },
    { id: 'messageAudio', field: 'messageAudio' },
    { id: 'messageVideo', field: 'messageVideo' },
    { id: 'instructionAudio', field: 'instructionAudio' }
  ];

  for (const fileInfo of filesToUpload) {
    const fileInput = document.querySelector(`input[name="${fileInfo.id}"]`);
    if (fileInput?.files[0]) {
      try {
        submission[fileInfo.field] = await toBase64(fileInput.files[0]);
      } catch (error) {
        console.error(`Error processing ${fileInfo.id}:`, error);
      }
    }
  }

  // Submit to Google Apps Script
  try {
    const response = await fetch(GOOGLE_SCRIPT_URL, {
      method: 'POST',
      body: JSON.stringify(submission),
      headers: { 'Content-Type': 'application/json' }
    });
    
    const result = await response.json();
    if (result.status === 'success') {
      // Store folder URL for future reference
      localStorage.setItem(`order_${submission.tokenNumber}`, result.folderUrl);
      return true;
    }
    throw new Error(result.message);
  } catch (err) {
    console.error('Submission error:', err);
    alert('Error submitting form: ' + err.message);
    return false;
  }
}

// Calculate total amount based on selections
function calculateTotalAmount() {
  const itemType = document.getElementById("itemType").value;
  let amount = 0;
  
  if (itemType === "message" || itemType === "writtenByTimeline") {
    amount = 249;
  } else if (itemType === "itemsSendByCustomer") {
    amount = 299;
  } else if (itemType === "itemsBuyByTimeline") {
    const productPrice = parseFloat(document.getElementById("productPrice").value) || 0;
    amount = 299 + productPrice;
  }
  
  document.getElementById("totalAmount").textContent = `Total Amount: ₹${amount}`;
  return amount;
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
  // Generate token if name is empty
  const customerName = document.getElementById('customerName');
  const tokenDisplay = document.getElementById('tokenDisplay');
  
  customerName.addEventListener('blur', function() {
    if (this.value === "") {
      tokenDisplay.textContent = "Your Token: " + generateToken();
    } else {
      tokenDisplay.textContent = "";
    }
  });
  
  // Initialize with token if name is empty
  if (customerName.value === "") {
    tokenDisplay.textContent = "Your Token: " + generateToken();
  }

  // Set minimum delivery date and time
  setMinDeliveryTime();
  
  // Show Popup for photo upload info
  document.getElementById("photoInfo").addEventListener("click", function(e) {
    e.preventDefault();
    alert("This photo is asked for better identification of recipient's during the time of delivery.");
  });

  // Initialize live delivery options
  document.getElementById("liveDelivery").addEventListener("change", function() {
    const liveDeliveryOptions = document.getElementById("liveDeliveryOptions");
    if (this.checked) {
      liveDeliveryOptions.innerHTML = `
        <label for="deliveryMethod">Delivery Method:</label>
        <select id="deliveryMethod" name="deliveryMethod">
          <option value="videoCall">Live delivery on video call</option>
          <option value="recorded">Recorded video of delivery</option>
        </select>
        <label for="platform">Choose Platform:</label>
        <select id="platform" name="platform">
          <option value="">-- Select Platform --</option>
          <option value="whatsapp">WhatsApp</option>
          <option value="googleMeet">Google Meet</option>
          <option value="instagram">Instagram</option>
        </select>
        <div id="platformDetails"></div>
      `;

      document.getElementById("platform").addEventListener("change", function() {
        const platformDetails = document.getElementById("platformDetails");
        switch (this.value) {
          case 'whatsapp':
            platformDetails.innerHTML = `
              <label for="whatsappNumber">Fill Your WhatsApp Number:</label>
              <input type="tel" id="whatsappNumber" name="whatsappNumber" placeholder="Enter your WhatsApp number" pattern="^[0-9]{10}$" required>
            `;
            break;
          case 'googleMeet':
            platformDetails.innerHTML = `
              <label for="email">Enter your Email:</label>
              <input type="email" id="email" name="email" placeholder="Enter your email" required>
            `;
            break;
          case 'instagram':
            platformDetails.innerHTML = `
              <label for="instagramId">Enter your Instagram ID:</label>
              <input type="text" id="instagramId" name="instagramId" placeholder="Enter your Instagram ID" required>
            `;
            break;
          default:
            platformDetails.innerHTML = '';
            break;
        }
      });
    } else {
      liveDeliveryOptions.innerHTML = '';
    }
  });

  // Initialize item type selection
  document.getElementById("itemType").addEventListener("change", function() {
    const selectedItemType = this.value;
    const additionalSections = document.getElementById("additionalSections");
    const totalAmountDiv = document.getElementById("totalAmount");

    switch (selectedItemType) {
      case 'message':
      case 'writtenByTimeline':
        additionalSections.innerHTML = `
          <h3>Write Your Message</h3>
          <textarea name="message" rows="4" placeholder="Write your message here..." required></textarea>
          <div class="upload-section">
            <h3>Your Message (Optional) <span class="info" onclick="showMessageInfo()">i</span></h3>
            <p>Upload an audio or video message to be played during delivery</p>
            <label class="file-input-label">
              Upload Audio (max 50MB): <input type="file" name="messageAudio" accept="audio/*">
            </label>
            <label class="file-input-label">
              Upload Video (max 200MB, MP4/MKV): <input type="file" name="messageVideo" accept="video/mp4,video/x-matroska">
            </label>
          </div>
          <div class="upload-section">
            <h3>Delivery Instructions <span class="info" onclick="showInstructionInfo()">i</span></h3>
            <p>Write or record instructions for the delivery person (at least one required)</p>
            <textarea name="instructions" rows="3" placeholder="Write your delivery instructions here..."></textarea>
            <label class="file-input-label">
              Or Upload Audio Instructions (max 10MB): <input type="file" name="instructionAudio" accept="audio/*">
            </label>
          </div>
        `;
        totalAmountDiv.textContent = "Total Amount: ₹249";
        break;
      case 'itemsSendByCustomer':
        additionalSections.innerHTML = `
          <h3>Send Item At</h3>
          <textarea rows="3" readonly>Time Line Office, Parle-G factory, Patanava, Ramnagar industrial area, Ramnagar, Varanasi, Uttar Pradesh, 221008</textarea>
          <button type="button" onclick="copyAddress()">Copy Address</button>
          <p class="instruction">Please write your token number on the delivery package for better identification.</p>
          <div class="upload-section">
            <h3>Your Message (Optional) <span class="info" onclick="showMessageInfo()">i</span></h3>
            <p>Upload an audio or video message to be played during delivery</p>
            <label class="file-input-label">
              Upload Audio (max 50MB): <input type="file" name="messageAudio" accept="audio/*">
            </label>
            <label class="file-input-label">
              Upload Video (max 200MB, MP4/MKV): <input type="file" name="messageVideo" accept="video/mp4,video/x-matroska">
            </label>
          </div>
          <div class="upload-section">
            <h3>Delivery Instructions <span class="info" onclick="showInstructionInfo()">i</span></h3>
            <p>Write or record instructions for the delivery person (at least one required)</p>
            <textarea name="instructions" rows="3" placeholder="Write your delivery instructions here..."></textarea>
            <label class="file-input-label">
              Or Upload Audio Instructions (max 10MB): <input type="file" name="instructionAudio" accept="audio/*">
            </label>
          </div>
          <label><input type="checkbox" id="claimWarranty" name="claimWarranty"> Claim Warranty <span class="info" onclick="showWarrantyInfo()">i</span></label>
        `;
        totalAmountDiv.textContent = "Total Amount: ₹299";
        break;
      case 'itemsBuyByTimeline':
        additionalSections.innerHTML = `
          <h3>Describe Your Product</h3>
          <textarea name="productDescription" rows="4" placeholder="Describe your product..." required></textarea>
          <h3>Product Price</h3>
          <input type="number" id="productPrice" name="productPrice" placeholder="Enter estimated product price" required>
          <p class="instruction">Please enter slightly higher amount than actual price as product may be available at higher rate in our area. If we get it cheaper, we'll refund the difference within 24 hours.</p>
          <h3>Optional: Product Link</h3>
          <input type="url" name="productLink" placeholder="Paste the product link here">
          <div class="upload-section">
            <h3>Your Message (Optional) <span class="info" onclick="showMessageInfo()">i</span></h3>
            <p>Upload an audio or video message to be played during delivery</p>
            <label class="file-input-label">
              Upload Audio (max 50MB): <input type="file" name="messageAudio" accept="audio/*">
            </label>
            <label class="file-input-label">
              Upload Video (max 200MB, MP4/MKV): <input type="file" name="messageVideo" accept="video/mp4,video/x-matroska">
            </label>
          </div>
          <div class="upload-section">
            <h3>Delivery Instructions <span class="info" onclick="showInstructionInfo()">i</span></h3>
            <p>Write or record instructions for the delivery person (at least one required)</p>
            <textarea name="instructions" rows="3" placeholder="Write your delivery instructions here..."></textarea>
            <label class="file-input-label">
              Or Upload Audio Instructions (max 10MB): <input type="file" name="instructionAudio" accept="audio/*">
            </label>
          </div>
        `;
        // Add event listener for price changes
        document.getElementById("productPrice").addEventListener("input", updateTotalAmount);
        updateTotalAmount();
        break;
      default:
        additionalSections.innerHTML = '';
        totalAmountDiv.textContent = "Total Amount: ₹0";
        break;
    }
  });

  // Ask Button Functionality
  document.getElementById("askButton").addEventListener("click", function() {
    const contactOptions = document.getElementById("contactOptions");
    contactOptions.style.display = contactOptions.style.display === "block" ? "none" : "block";
  });

  // Form submission
  const form = document.getElementById("orderForm");
  
  form.addEventListener("submit", async function(event) {
    event.preventDefault();
    
    // Validate pincode
    const pincode = document.getElementById('pincode');
    if (!/^\d{6}$/.test(pincode.value)) {
      alert("Pin code must be exactly 6 digits");
      pincode.focus();
      return;
    }
    
    // Validate delivery instructions (at least one required)
    const instructionsText = document.querySelector('textarea[name="instructions"]')?.value;
    const instructionAudio = document.querySelector('input[name="instructionAudio"]')?.files[0];
    if (!instructionsText && !instructionAudio) {
      alert("Please provide delivery instructions (text or audio)");
      return;
    }
    
    // Validate live delivery options if checked
    const liveDeliveryChecked = document.getElementById('liveDelivery').checked;
    if (liveDeliveryChecked) {
      const platform = document.getElementById('platform');
      if (!platform || !platform.value) {
        alert("Please select a platform for live delivery");
        return;
      }
      
      let valid = true;
      
      if (platform.value === 'whatsapp' && !document.getElementById('whatsappNumber').value) {
        valid = false;
        alert("Please enter your WhatsApp number for live delivery");
      } else if (platform.value === 'googleMeet' && !document.getElementById('email').value) {
        valid = false;
        alert("Please enter your email for Google Meet live delivery");
      } else if (platform.value === 'instagram' && !document.getElementById('instagramId').value) {
        valid = false;
        alert("Please enter your Instagram ID for live delivery");
      }
      
      if (!valid) return;
    }
    
    // Validate file sizes
    const messageAudio = document.querySelector('input[name="messageAudio"]');
    if (messageAudio && messageAudio.files[0] && messageAudio.files[0].size > 50 * 1024 * 1024) {
      alert("Message audio file must be less than 50MB");
      return;
    }
    
    const messageVideo = document.querySelector('input[name="messageVideo"]');
    if (messageVideo && messageVideo.files[0]) {
      if (messageVideo.files[0].size > 200 * 1024 * 1024) {
        alert("Message video file must be less than 200MB");
        return;
      }
      const validFormats = ['video/mp4', 'video/x-matroska'];
      if (!validFormats.includes(messageVideo.files[0].type)) {
        alert("Video must be in MP4 or MKV format");
        return;
      }
    }
    
    const instructionAudioFile = document.querySelector('input[name="instructionAudio"]');
    if (instructionAudioFile && instructionAudioFile.files[0] && instructionAudioFile.files[0].size > 10 * 1024 * 1024) {
      alert("Instruction audio file must be less than 10MB");
      return;
    }
    
    // Submit form data
    const formData = {
      customerName: document.getElementById("customerName").value,
      phoneNumber: document.getElementById("phoneNumber").value,
      recipientName: document.getElementById("recipientName").value,
      recipientPhoneNumber: document.getElementById("recipientPhoneNumber").value,
      address: document.getElementById("address").value,
      district: document.getElementById("district").value,
      state: document.getElementById("state").value,
      pincode: document.getElementById("pincode").value,
      itemType: document.getElementById("itemType").value,
      deliveryDate: document.getElementById("deliveryDate").value,
      deliveryTime: document.getElementById("deliveryTime").value
    };
    
    const success = await submitFormData(formData);
    if (success) {
      // Store order details in localStorage for payment page
      localStorage.setItem("orderDetails", JSON.stringify({
        customerName: document.getElementById("customerName").value || document.getElementById("tokenDisplay").textContent,
        totalAmount: calculateTotalAmount()
      }));
      
      // Redirect to payment page
      window.location.href = "payment.html";
    }
  });
});

function setMinDeliveryTime() {
  const now = new Date();
  const deliveryDate = document.getElementById('deliveryDate');
  const deliveryTime = document.getElementById('deliveryTime');
  
  // Set minimum date to today
  const today = now.toISOString().split('T')[0];
  deliveryDate.min = today;
  
  // Set minimum time to 2 hours from now
  now.setHours(now.getHours() + 2);
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const minTime = `${hours}:${minutes}`;
  
  // If delivery date is today, set min time
  if (deliveryDate.value === today) {
    deliveryTime.min = minTime;
  }
  
  // Update time min when date changes
  deliveryDate.addEventListener('change', function() {
    if (this.value === today) {
      deliveryTime.min = minTime;
    } else {
      deliveryTime.removeAttribute('min');
    }
  });
}

function showInstructionInfo() {
  alert("Delivery instructions help our team understand how you want the delivery to be performed. Please provide clear instructions for the best experience.");
}

function showMessageInfo() {
  alert("Adding a personal message makes the delivery more special. You can record your voice or video message that will be played during delivery.");
}

function showWarrantyInfo() {
  alert("By claiming warranty, you authorize us to open your package upon arrival and record a video/pictures of the contents. If recipient reports any damage or missing items, we'll refund full amount (excluding ₹100 fuel charge).");
}

function copyAddress() {
  const addressText = document.querySelector('textarea[readonly]');
  addressText.select();
  document.execCommand('copy');
  alert("Address copied to clipboard!");
}

function closePopup() {
  document.getElementById('popup').style.display = 'none';
}

function redirectToInstagram() {
  window.open("https://www.instagram.com/time_line.official", "_blank");
}

function redirectToGmail() {
  window.location.href = "mailto:timelinedeliveryofficial@gmail.com";
}

function hideContactOptions() {
  document.getElementById("contactOptions").style.display = "none";
}

function updateTotalAmount() {
  calculateTotalAmount();
}

// Initialize total amount calculation
document.getElementById("itemType").addEventListener("change", calculateTotalAmount);
</script></body></html>
